/** * Generic database fetching utilities with Map-based O(1) lookups * Consolidates repeated pattern from fetchObjectsByIds, fetchItemsByIds, fetchHourlyRatesByIds */import { Model } from "mongoose";/** * Generic function to fetch multiple documents by IDs with Map-based lookup * Maintains order of input IDs and returns null for missing items *  * @param model - Mongoose model to query * @param ids - Array of IDs to fetch * @param idField - Name of the ID field (e.g., 'idObjet', 'idClient') * @returns Array of documents in same order as input IDs, with null for missing items *  * @example * const products = await fetchByIds(DbObjet, [1, 2, 3], 'idObjet'); * const clients = await fetchByIds(DbClient, [5, 6], 'idClient'); */export async function fetchByIds<T>(    model: Model<T>,    ids: number[],    idField: string): Promise<(T | null)[]> {    if (!ids.length) return [];    try {        // Fetch all documents matching the IDs        const documents = await model.find(            { [idField]: { $in: ids } } as any,            { _id: 0 } // Exclude MongoDB _id for better performance        ).lean<T[]>();        // Create a Map for O(1) lookup instead of O(n) for each id        const documentMap = new Map(            documents.map(doc => [(doc as any)[idField], doc])        );        // Return documents in same order as input IDs, null for missing        return ids.map(id => documentMap.get(id) || null);    } catch (error) {        console.error('Database Error:', error);        throw new Error(`Failed to fetch items by IDs from ${model.modelName}.`);    }}/** * Creates a specialized fetcher function for a specific model * Useful for creating dedicated functions with better type safety *  * @example * export const fetchObjectsByIds = createIdFetcher<Objet>(DbObjet, 'idObjet'); * export const fetchClientsByIds = createIdFetcher<Client>(DbClient, 'idClient'); */export function createIdFetcher<T>(    model: Model<T>,    idField: string): (ids: number[]) => Promise<(T | null)[]> {    return (ids: number[]) => fetchByIds(model, ids, idField);}